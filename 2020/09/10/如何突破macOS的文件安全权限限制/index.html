<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="如何突破macOS的文件安全权限限制 [ Friend ] "><meta name="theme-color" content="#ebc65a"><title>如何突破macOS的文件安全权限限制 [ Friend ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=xx-xxxxxxx-xx" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'xx-xxxxxxx-xx');</script><link rel="stylesheet" href="/css/tocbot.css"><script src="/js/tocbot.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">Friend</a></h1><p></p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">如何突破macOS的文件安全权限限制</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">如何突破macOS的文件安全权限限制</a></h2><span class="post__date">2020-09-10</span><a href="/tags/Mac/"><span class="post__tags">#Mac</span></a></div></div><div class="article__content"><p>今天在尝试用Python连接Oracle数据库时遇到一个报错：</p>
<pre><code class="hljs undefined">cx_Oracle.DatabaseError: DPI-1047: Cannot locate a 64-bit Oracle<span class="hljs-built_in"> Client </span>library: <span class="hljs-string">"dlopen(libclntsh.dylib, 1): no suitable image found.</span></code></pre>
<p>大致是需要一个64位的Oracle客户端，而我的Mac上没有，那么解决方案也很简单，去下一个就好，为了轻便选择了Instant Oracle（instantclient-basiclite-macos.x64-19.3.0.0.0dbru.zip）<a href="https://www.oracle.com/database/technologies/instant-client/macos-intel-x86-downloads.html" target="_blank" rel="noopener">下载地址</a>。然后遵循如下操作即可完成轻量Oracle客户端的安装：</p>
<ol>
<li><p>创建文件夹，并将压缩包解压到这个文件夹下</p>
<pre><code class="hljs undefined">sudo mkdir -p /opt/oracle
sudp cp instantclient-basic-macos.x64<span class="hljs-number">-19.3</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>dbru.zip /opt/oracle/（如果当前在下载文件所在目录下）
cd /opt/oracle/
sudo unzip instantclient-basic-macos.x64<span class="hljs-number">-19.3</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>dbru.zip</code></pre>
</li>
<li><p>创建超链接，以使应用程序能够找到该库</p>
<pre><code class="hljs undefined">mkdir ~<span class="hljs-regexp">/lib
ln -s /opt</span><span class="hljs-regexp">/oracle/instantclient</span>_19_3/libclntsh.dylib ~<span class="hljs-regexp">/lib/</span></code></pre>
</li>
</ol>
<p>到此应该再执行Python的数据读取程序就可以成功了，但是他出现了：（当时没截图，从网上找的，版本号不太对但不影响）</p>
<p><img src="/2020/09/10/如何突破macOS的文件安全权限限制/security.png" alt="security"></p>
<p>这也没吓住我，去系统设置的安全项里给他解封了就好，但是我解封之后仍然遇到同样的错误，这就一时摸不着头脑了。</p>
<p>Google了一番，发现<a href="http://oraontap.blogspot.com/2020/01/mac-os-x-catalina-and-oracle-instant.html" target="_blank" rel="noopener">这篇文章</a>，通过<code>ls -lg@</code>命令，我们可以得到以下：</p>
<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ls -lg@</span>
total 484136
-r-xr-xr-x@ 1 staff       5780 Feb 22  2019 BASIC_LICENSE
 com.apple.quarantine        57 
-rw-r--r--@ 1 staff       1670 Aug 19 05:57 BASIC_README
 com.apple.quarantine        57 
-r-xr-xr-x@ 1 staff       5780 Feb 22  2019 SQLPLUS_LICENSE
 com.apple.quarantine        57 
-rw-r--r--@ 1 staff       1676 Sep  6 04:11 SQLPLUS_README
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff       9888 Aug 19 05:57 adrci
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff      40368 Aug 19 05:57 genezi
 com.apple.quarantine        57 
-r-xr-xr-x@ 1 staff        342 Apr 24  2015 glogin.sql
 com.apple.quarantine        57 
lrwxrwxrwx  1 staff         20 Jan 16 08:39 libclntsh.dylib -&gt; libclntsh.dylib.19.1
lrwxrwxrwx  1 staff         20 Jan 16 08:39 libclntsh.dylib.10.1 -&gt; libclntsh.dylib.19.1
lrwxrwxrwx  1 staff         20 Jan 16 08:39 libclntsh.dylib.11.1 -&gt; libclntsh.dylib.19.1
lrwxrwxrwx  1 staff         20 Jan 16 08:39 libclntsh.dylib.12.1 -&gt; libclntsh.dylib.19.1
lrwxrwxrwx  1 staff         20 Jan 16 08:39 libclntsh.dylib.18.1 -&gt; libclntsh.dylib.19.1
-rwxr-xr-x@ 1 staff   98137256 Aug 13 02:10 libclntsh.dylib.19.1
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff    4803832 Jul  7  2019 libclntshcore.dylib.19.1
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff    8349944 Aug  6 12:14 libnnz19.dylib
 com.apple.quarantine        57 
lrwxrwxrwx  1 staff         18 Jan 16 08:39 libocci.dylib -&gt; libocci.dylib.19.1
lrwxrwxrwx  1 staff         18 Jan 16 08:39 libocci.dylib.10.1 -&gt; libocci.dylib.19.1
lrwxrwxrwx  1 staff         18 Jan 16 08:39 libocci.dylib.11.1 -&gt; libocci.dylib.19.1
lrwxrwxrwx  1 staff         18 Jan 16 08:39 libocci.dylib.12.1 -&gt; libocci.dylib.19.1
lrwxrwxrwx  1 staff         18 Jan 16 08:39 libocci.dylib.18.1 -&gt; libocci.dylib.19.1
-rwxr-xr-x@ 1 staff    1594048 Jul  5  2019 libocci.dylib.19.1
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff  125518764 Aug 19 05:57 libociei.dylib
 com.apple.quarantine        57 
-r-xr-xr-x@ 1 staff     151980 Jul  3  2019 libocijdbc19.dylib
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff     100492 Aug 13 02:32 liboramysql19.dylib
 com.apple.quarantine        57 
-rwxrwxrwx@ 1 staff    1322588 Sep  6 04:05 libsqlplus.dylib
 com.apple.quarantine        57 
-r-xr-xr-x@ 1 staff    1659868 Jul  5  2019 libsqlplusic.dylib
 com.apple.quarantine        57 
drwxr-xr-x@ 3 staff         96 Aug 19 05:57 network
 com.apple.quarantine        57 
-rw-r--r--@ 1 staff    4210510 May 10  2019 ojdbc8.jar
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff       8528 Sep  6 04:11 sqlplus
 com.apple.quarantine        57 
-rw-r--r--@ 1 staff    1680080 May 10  2019 ucp.jar
 com.apple.quarantine        57 
-rwxr-xr-x@ 1 staff     150080 Aug 19 05:57 uidrvci
 com.apple.quarantine        57 
-rw-r--r--@ 1 staff      74263 Apr 16  2019 xstreams.jar
 com.apple.quarantine        57</code></pre>
<p>这里不难看出macOS通过文件上的<code>com.apple.quarantine</code>标签来判断该文件是否应该被过滤，简单的解决方法就是把这些标签删掉，<em>注意！！：执行以下操作前请务必判断程序无问题，不然会给Mac带来感染病毒的风险</em></p>
<ol>
<li><p>先给所有文件写权限，因为有些文件没有该权限：</p>
<pre><code class="hljs undefined"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> instantclient_19_3</span>
<span class="hljs-meta">$</span><span class="bash"> sudo chmod u+w *</span></code></pre>
</li>
<li><p>删除<code>com.apple.quarantine</code>标签：</p>
<pre><code class="hljs undefined"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> ..</span>
<span class="hljs-meta">$</span><span class="bash"> xattr -r -d -s com.apple.quarantine instantclient_19_3</span></code></pre>
</li>
</ol>
<p>这只是一种应用场景，实际上可以应用在更多被隔离的<strong>安全软件</strong>上，使用之前请先权衡，安全第一位。</p>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a></li></ul></div><h2>Categories</h2><div class="sidebar__categories"></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button">没有更多</a><a class="next-button" href="/2020/09/08/vim搭建python环境/">vim搭建python环境</a></div></div></div></div><div class="footer"><span>©️2019-2020 Designed By&nbsp;<strong><a href="https://github.com/random-yang">RandomYang</a></strong> Powered By&nbsp;</span><strong><a href="https://hexo.io">hexo</a></strong></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>